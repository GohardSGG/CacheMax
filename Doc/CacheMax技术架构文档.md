# CacheMax v2.0 æŠ€æœ¯æ¶æ„æ–‡æ¡£

## ğŸ“‹ ç›®å½•
1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
3. [æ ¸å¿ƒç»„ä»¶](#æ ¸å¿ƒç»„ä»¶)
4. [æ•°æ®æµç¨‹](#æ•°æ®æµç¨‹)
5. [APIæ¥å£è®¾è®¡](#apiæ¥å£è®¾è®¡)
6. [é…ç½®ç³»ç»Ÿ](#é…ç½®ç³»ç»Ÿ)
7. [é”™è¯¯å¤„ç†](#é”™è¯¯å¤„ç†)
8. [æ€§èƒ½ç›‘æ§](#æ€§èƒ½ç›‘æ§)
9. [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
10. [éƒ¨ç½²è¯´æ˜](#éƒ¨ç½²è¯´æ˜)

---

## é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®ç®€ä»‹
CacheMax v2.0 æ˜¯ä¸€ä¸ªWindowsæ–‡ä»¶ç³»ç»ŸåŠ é€Ÿå·¥å…·ï¼Œé€šè¿‡ç¬¦å·é“¾æ¥æŠ€æœ¯å°†ç”¨æˆ·æ–‡ä»¶å¤¹é‡å®šå‘åˆ°é«˜é€Ÿå­˜å‚¨ï¼ˆå¦‚NVMe SSDï¼‰ï¼Œå®ç°æ–‡ä»¶è®¿é—®æ€§èƒ½æå‡ã€‚ç›¸æ¯”ä¼ ç»Ÿçš„è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæ–¹æ¡ˆï¼Œç¬¦å·é“¾æ¥æ¶æ„æä¾›äº†æ›´å¥½çš„å…¼å®¹æ€§å’Œæ€§èƒ½è¡¨ç°ã€‚

**å·¥ä½œåŸç†**ï¼š
1. **é€æ˜é‡å®šå‘**ï¼šå°†ç”¨æˆ·æŒ‡å®šçš„æ–‡ä»¶å¤¹ï¼ˆå¦‚é¡¹ç›®ç›®å½•ï¼‰ç§»åŠ¨åˆ°é«˜é€Ÿç¼“å­˜ä½ç½®ï¼Œç„¶ååœ¨åŸä½ç½®åˆ›å»ºç¬¦å·é“¾æ¥æŒ‡å‘ç¼“å­˜ã€‚è¿™æ ·åº”ç”¨ç¨‹åºä»ç„¶æŒ‰åŸè·¯å¾„è®¿é—®æ–‡ä»¶ï¼Œä½†å®é™…è¯»å†™å‘ç”Ÿåœ¨é«˜é€Ÿå­˜å‚¨ä¸Šã€‚

2. **æ™ºèƒ½åŒæ­¥**ï¼šç³»ç»ŸæŒç»­ç›‘æ§ç¼“å­˜ç›®å½•çš„æ–‡ä»¶å˜åŒ–ï¼Œå¹¶æ™ºèƒ½åœ°å°†ä¿®æ”¹åŒæ­¥å›åŸå§‹å­˜å‚¨ä½ç½®ã€‚åŒæ­¥ç­–ç•¥åŒ…æ‹¬å³æ—¶åŒæ­¥ï¼ˆé€‚åˆå°æ–‡ä»¶ï¼‰ã€æ‰¹é‡åŒæ­¥ï¼ˆé€‚åˆé¢‘ç¹ä¿®æ”¹ï¼‰å’Œå®šæœŸåŒæ­¥ï¼ˆé€‚åˆå¤§æ–‡ä»¶ï¼‰ã€‚

3. **æ€§èƒ½æå‡**ï¼šé€šè¿‡åˆ©ç”¨NVMe SSDçš„é«˜é€Ÿéšæœºè¯»å†™èƒ½åŠ›ï¼Œå…¸å‹åœºæ™¯ä¸‹å¯ä»¥å°†æ–‡ä»¶è®¿é—®é€Ÿåº¦ä»ä¼ ç»Ÿç¡¬ç›˜çš„65 MB/sæå‡åˆ°1500+ MB/sï¼Œæå‡è¶…è¿‡20å€ã€‚

**åº”ç”¨åœºæ™¯**ï¼š
- **å¼€å‘ç¯å¢ƒåŠ é€Ÿ**ï¼šåŠ é€Ÿä»£ç ç¼–è¯‘ã€IDEå“åº”å’Œç‰ˆæœ¬æ§åˆ¶æ“ä½œ
- **å†…å®¹åˆ›ä½œåŠ é€Ÿ**ï¼šæå‡è§†é¢‘ç¼–è¾‘ã€å›¾ç‰‡å¤„ç†ç­‰å·¥ä½œæµç¨‹
- **æ¸¸æˆæ€§èƒ½ä¼˜åŒ–**ï¼šå‡å°‘æ¸¸æˆåŠ è½½æ—¶é—´å’Œè´´å›¾æµé€å»¶è¿Ÿ
- **æ•°æ®åº“åŠ é€Ÿ**ï¼šæå‡æ•°æ®åº“æŸ¥è¯¢å’Œäº‹åŠ¡å¤„ç†æ€§èƒ½

### 1.2 æ ¸å¿ƒç‰¹æ€§
- **ç¬¦å·é“¾æ¥åŠ é€Ÿ**ï¼šé€æ˜çš„æ–‡ä»¶å¤¹åŠ é€Ÿï¼Œå…¼å®¹æ€§å¼º
- **æ™ºèƒ½åŒæ­¥**ï¼šå¤šç§åŒæ­¥æ¨¡å¼ï¼ˆå³æ—¶ã€æ‰¹é‡ã€å®šæœŸï¼‰
- **æ™ºèƒ½é‡è¯•æœºåˆ¶**ï¼šæ–‡ä»¶é”æ£€æµ‹å’Œè‡ªåŠ¨é‡è¯•ï¼Œé¿å…åŒæ­¥å†²çª
- **æ€§èƒ½ç›‘æ§**ï¼šå®æ—¶ç›‘æ§æ–‡ä»¶æ“ä½œå’Œæ€§èƒ½æŒ‡æ ‡
- **é”™è¯¯æ¢å¤**ï¼šè‡ªåŠ¨æ•…éšœæ£€æµ‹å’Œæ¢å¤æœºåˆ¶
- **å¥åº·æ£€æŸ¥**ï¼šç³»ç»Ÿå®Œæ•´æ€§éªŒè¯

### 1.3 æŠ€æœ¯æ ˆ
- **æ¡†æ¶**ï¼š.NET 8.0 WPF
- **è¯­è¨€**ï¼šC# 12.0
- **å¹³å°**ï¼šWindows 10/11 (x64)
- **æƒé™**ï¼šéœ€è¦ç®¡ç†å‘˜æƒé™ï¼ˆç¬¦å·é“¾æ¥åˆ›å»ºï¼‰

---

## æŠ€æœ¯æ¶æ„

### 2.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç”¨æˆ·ç•Œé¢å±‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ MainWindow  â”‚  â”‚ é…ç½®ç®¡ç†UI   â”‚  â”‚ çŠ¶æ€æ˜¾ç¤º  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ WPFæ•°æ®ç»‘å®š & äº‹ä»¶
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æœåŠ¡å±‚                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ CacheManager    â”‚ â”‚ PerformanceMonitoring   â”‚ â”‚
â”‚  â”‚ Service         â”‚ â”‚ Service                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ FileSyncService â”‚ â”‚ ErrorRecoveryService    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ SymbolicLink    â”‚ â”‚ ConfigService           â”‚ â”‚
â”‚  â”‚ Service         â”‚ â”‚                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚  â”‚ SafeFile        â”‚     (æ–‡ä»¶é”æ£€æµ‹å’Œé‡è¯•)      â”‚
â”‚  â”‚ Operations      â”‚                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ P/Invoke & Win32 API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 ç³»ç»Ÿå±‚                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æ–‡ä»¶ç³»ç»ŸAPI     â”‚ â”‚ ç¬¦å·é“¾æ¥API              â”‚ â”‚
â”‚  â”‚ FileSystemWatcherâ”‚ â”‚ CreateSymbolicLink      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æ€§èƒ½è®¡æ•°å™¨API   â”‚ â”‚ æƒé™æ£€æŸ¥API              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 åˆ†å±‚è¯´æ˜

#### ç”¨æˆ·ç•Œé¢å±‚ (Presentation Layer)
**æ¶æ„è®¾è®¡ç†å¿µ**ï¼šé‡‡ç”¨MVVMï¼ˆModel-View-ViewModelï¼‰æ¨¡å¼ï¼Œç¡®ä¿ç•Œé¢é€»è¾‘ä¸ä¸šåŠ¡é€»è¾‘çš„åˆ†ç¦»ã€‚ç•Œé¢å±‚è´Ÿè´£æ¥æ”¶ç”¨æˆ·è¾“å…¥ã€å±•ç¤ºç³»ç»ŸçŠ¶æ€ï¼Œå¹¶é€šè¿‡æ•°æ®ç»‘å®šä¸åº•å±‚æœåŠ¡è¿›è¡Œé€šä¿¡ã€‚

**ä¸»è¦ç»„ä»¶**ï¼š
- **MainWindow**ï¼šä¸»ç•Œé¢çª—å£ï¼Œæä¾›åŠ é€Ÿç®¡ç†ã€é…ç½®è®¾ç½®å’ŒçŠ¶æ€ç›‘æ§åŠŸèƒ½
- **é…ç½®ç®¡ç†UI**ï¼šå…è®¸ç”¨æˆ·è‡ªå®šä¹‰åŒæ­¥ç­–ç•¥ã€ç¼“å­˜ä½ç½®ç­‰å‚æ•°
- **çŠ¶æ€æ˜¾ç¤ºé¢æ¿**ï¼šå®æ—¶æ˜¾ç¤ºæ€§èƒ½æŒ‡æ ‡ã€åŒæ­¥çŠ¶æ€å’Œé”™è¯¯ä¿¡æ¯
- **ProgressæŠ¥å‘Š**ï¼šåœ¨é•¿æ—¶é—´æ“ä½œï¼ˆå¦‚åˆå§‹åŒ–åŠ é€Ÿã€å¼ºåˆ¶åŒæ­¥ï¼‰æ—¶æä¾›è¿›åº¦åé¦ˆ

**äº¤äº’æµç¨‹**ï¼šç”¨æˆ·ç‚¹å‡»"å¼€å§‹åŠ é€Ÿ"æŒ‰é’® â†’ UIéªŒè¯è¾“å…¥å‚æ•° â†’ è°ƒç”¨CacheManagerService â†’ æ˜¾ç¤ºè¿›åº¦æ¡ â†’ æ›´æ–°çŠ¶æ€æ˜¾ç¤º â†’ å®Œæˆåæ˜¾ç¤ºç»“æœå¯¹è¯æ¡†

#### æœåŠ¡å±‚ (Service Layer)
**æ¶æ„è®¾è®¡ç†å¿µ**ï¼šæœåŠ¡å±‚æ˜¯ç³»ç»Ÿçš„æ ¸å¿ƒï¼Œé‡‡ç”¨æ¾è€¦åˆçš„æœåŠ¡å¯¼å‘æ¶æ„ã€‚æ¯ä¸ªæœåŠ¡ä¸“æ³¨äºç‰¹å®šåŠŸèƒ½åŸŸï¼Œé€šè¿‡äº‹ä»¶å’Œæ¥å£è¿›è¡Œåä½œã€‚è¿™ç§è®¾è®¡ä¾¿äºå•å…ƒæµ‹è¯•ã€åŠŸèƒ½æ‰©å±•å’Œæ•…éšœéš”ç¦»ã€‚

**æœåŠ¡åä½œæ¨¡å¼**ï¼š
- **CacheManagerService**ä½œä¸ºé—¨é¢æœåŠ¡ï¼Œåè°ƒå…¶ä»–æ‰€æœ‰æœåŠ¡
- **äº‹ä»¶é©±åŠ¨é€šä¿¡**ï¼šæœåŠ¡é—´é€šè¿‡.NETäº‹ä»¶ç³»ç»Ÿè¿›è¡Œå¼‚æ­¥é€šä¿¡
- **ä¾èµ–æ³¨å…¥ready**ï¼šè™½ç„¶å½“å‰ä½¿ç”¨ç›´æ¥å®ä¾‹åŒ–ï¼Œæ¶æ„æ”¯æŒæœªæ¥å¼•å…¥DIå®¹å™¨
- **é”™è¯¯è¾¹ç•Œ**ï¼šæ¯ä¸ªæœåŠ¡æœ‰ç‹¬ç«‹çš„é”™è¯¯å¤„ç†ï¼Œé¿å…çº§è”å¤±è´¥

**ç”Ÿå‘½å‘¨æœŸç®¡ç†**ï¼šæœåŠ¡åœ¨åº”ç”¨å¯åŠ¨æ—¶åˆå§‹åŒ–ï¼Œåœ¨åº”ç”¨é€€å‡ºæ—¶ä¼˜é›…å…³é—­ã€‚æ”¯æŒçƒ­é‡è½½é…ç½®å’ŒåŠ¨æ€æœåŠ¡çŠ¶æ€è°ƒæ•´ã€‚

#### ç³»ç»Ÿå±‚ (System Layer)
**è®¾è®¡åŸåˆ™**ï¼šç³»ç»Ÿå±‚å°è£…äº†æ‰€æœ‰ä¸æ“ä½œç³»ç»Ÿçš„ç›´æ¥äº¤äº’ï¼Œä¸ºä¸Šå±‚æä¾›æŠ½è±¡çš„ã€ç±»å‹å®‰å…¨çš„æ¥å£ã€‚é€šè¿‡P/InvokeæŠ€æœ¯è°ƒç”¨Windows APIï¼ŒåŒæ—¶æä¾›.NETå‹å¥½çš„é”™è¯¯å¤„ç†å’Œå‚æ•°éªŒè¯ã€‚

**æ ¸å¿ƒèƒ½åŠ›**ï¼š
- **ç¬¦å·é“¾æ¥ç®¡ç†**ï¼šå°è£…`CreateSymbolicLink`ã€`GetFileAttributes`ç­‰API
- **æ–‡ä»¶ç³»ç»Ÿç›‘æ§**ï¼šåŸºäº`FileSystemWatcher`å’Œåº•å±‚I/Oå®Œæˆç«¯å£
- **æƒé™æ£€æŸ¥**ï¼šé›†æˆWindowså®‰å…¨æ¨¡å‹ï¼Œæ£€æŸ¥ç®¡ç†å‘˜æƒé™å’Œæ–‡ä»¶è®¿é—®æƒé™
- **æ€§èƒ½è®¡æ•°å™¨**ï¼šåˆ©ç”¨Windowsæ€§èƒ½æ¡†æ¶æ”¶é›†ç³»ç»Ÿçº§æ€§èƒ½æ•°æ®

**å®‰å…¨è€ƒè™‘**ï¼šæ‰€æœ‰ç³»ç»Ÿå±‚æ“ä½œéƒ½åŒ…å«æƒé™éªŒè¯ã€è¾“å…¥æ¸…ç†å’Œå¼‚å¸¸å¤„ç†ï¼Œé˜²æ­¢æ¶æ„è¾“å…¥å¯¼è‡´çš„ç³»ç»Ÿä¸ç¨³å®šã€‚

---

## æ ¸å¿ƒç»„ä»¶

### 3.1 CacheManagerService - ç¼“å­˜ç®¡ç†æ ¸å¿ƒ

**è®¾è®¡ç†å¿µ**ï¼šCacheManagerServiceæ˜¯æ•´ä¸ªç³»ç»Ÿçš„åè°ƒä¸­å¿ƒï¼Œé‡‡ç”¨é—¨é¢æ¨¡å¼è®¾è®¡ï¼Œä¸ºUIå±‚æä¾›ç®€åŒ–çš„ã€é«˜çº§çš„æ“ä½œæ¥å£ã€‚å®ƒå°è£…äº†å¤æ‚çš„å¤šæ­¥éª¤æ“ä½œæµç¨‹ï¼Œç¡®ä¿å„ä¸ªå­æœåŠ¡æŒ‰æ­£ç¡®é¡ºåºåä½œï¼Œå¹¶æä¾›ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’ŒçŠ¶æ€åé¦ˆã€‚

**æ ¸å¿ƒèŒè´£è¯¦è§£**ï¼š

1. **åŠ é€Ÿç”Ÿå‘½å‘¨æœŸç®¡ç†**ï¼š
   - **åˆå§‹åŒ–é˜¶æ®µ**ï¼šéªŒè¯æƒé™â†’å¤åˆ¶æ–‡ä»¶åˆ°ç¼“å­˜â†’é‡å‘½ååŸç›®å½•â†’åˆ›å»ºç¬¦å·é“¾æ¥â†’å¯åŠ¨ç›‘æ§æœåŠ¡
   - **è¿è¡Œé˜¶æ®µ**ï¼šåè°ƒæ–‡ä»¶åŒæ­¥ã€æ€§èƒ½ç›‘æ§ã€é”™è¯¯æ¢å¤ç­‰æœåŠ¡
   - **åœæ­¢é˜¶æ®µ**ï¼šåœæ­¢ç›‘æ§â†’æœ€ååŒæ­¥â†’åˆ é™¤ç¬¦å·é“¾æ¥â†’æ¢å¤åŸç›®å½•â†’æ¸…ç†èµ„æº

2. **æœåŠ¡ç¼–æ’**ï¼š
   - ç®¡ç†6ä¸ªå­æœåŠ¡çš„å¯åŠ¨é¡ºåºå’Œä¾èµ–å…³ç³»
   - å¤„ç†æœåŠ¡é—´çš„å¼‚æ­¥é€šä¿¡å’Œäº‹ä»¶è½¬å‘
   - å®ç°ä¼˜é›…é™çº§ï¼ˆæŸä¸ªæœåŠ¡å¤±è´¥æ—¶ç³»ç»Ÿä»å¯éƒ¨åˆ†å·¥ä½œï¼‰

3. **çŠ¶æ€ä¸€è‡´æ€§ç»´æŠ¤**ï¼š
   - ç»´æŠ¤åŠ é€Ÿé¡¹ç›®çš„å…¨å±€çŠ¶æ€æ˜ å°„
   - å¤„ç†å¹¶å‘æ“ä½œçš„åŒæ­¥é—®é¢˜
   - æä¾›äº‹åŠ¡æ€§æ“ä½œä¿è¯ï¼ˆè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å›æ»šï¼‰

```csharp
public class CacheManagerService
{
    // æœåŠ¡ç»„åˆï¼šé‡‡ç”¨ç»„åˆæ¨¡å¼ç®¡ç†å¤šä¸ªå­æœåŠ¡
    private readonly SymbolicLinkService _symbolicLinkService;
    private readonly FileSyncService _fileSyncService;
    private readonly ErrorRecoveryService _errorRecovery;
    private readonly PerformanceMonitoringService _performanceMonitor;

    // æ ¸å¿ƒæ“ä½œæµç¨‹
    public async Task<bool> InitializeCacheAcceleration(string sourcePath, string cacheRoot)
    {
        // 6æ­¥åŸå­æ“ä½œï¼šä»»ä½•ä¸€æ­¥å¤±è´¥éƒ½ä¼šè‡ªåŠ¨å›æ»š
        // 1. æƒé™æ£€æŸ¥ 2. è·¯å¾„éªŒè¯ 3. æ–‡ä»¶å¤åˆ¶ 4. ç›®å½•é‡å‘½å 5. ç¬¦å·é“¾æ¥åˆ›å»º 6. ç›‘æ§å¯åŠ¨
    }
}
```

**è®¾è®¡æ¨¡å¼åº”ç”¨**ï¼š
- **é—¨é¢æ¨¡å¼**ï¼šä¸ºUIå±‚éšè—å¤æ‚çš„æœåŠ¡åè°ƒé€»è¾‘
- **è§‚å¯Ÿè€…æ¨¡å¼**ï¼šé€šè¿‡äº‹ä»¶ç³»ç»Ÿå®ç°æ¾è€¦åˆçš„çŠ¶æ€é€šçŸ¥
- **å‘½ä»¤æ¨¡å¼**ï¼šå°†å¤æ‚æ“ä½œå°è£…ä¸ºå¯æ’¤é”€çš„å‘½ä»¤å¯¹è±¡
- **çŠ¶æ€æ¨¡å¼**ï¼šæ ¹æ®åŠ é€Ÿé¡¹ç›®çŠ¶æ€æ‰§è¡Œä¸åŒçš„æ“ä½œé€»è¾‘

**é”™è¯¯å¤„ç†ç­–ç•¥**ï¼š
- **åŸå­æ€§ä¿è¯**ï¼šæ‰€æœ‰ä¿®æ”¹æ“ä½œéƒ½æ”¯æŒå›æ»š
- **å¼‚å¸¸åˆ†ç±»**ï¼šåŒºåˆ†ç³»ç»Ÿé”™è¯¯ã€ç”¨æˆ·é”™è¯¯ã€é…ç½®é”™è¯¯ç­‰
- **ä¼˜é›…é™çº§**ï¼šéƒ¨åˆ†åŠŸèƒ½å¤±è´¥æ—¶ç³»ç»Ÿä»å¯æä¾›åŸºæœ¬æœåŠ¡

### 3.2 SymbolicLinkService - ç¬¦å·é“¾æ¥ç®¡ç†

**æ ¸å¿ƒä½œç”¨**ï¼šSymbolicLinkServiceæ˜¯å®ç°é€æ˜æ–‡ä»¶å¤¹é‡å®šå‘çš„å…³é”®ç»„ä»¶ã€‚å®ƒè´Ÿè´£åˆ›å»ºå’Œç®¡ç†NTFSç¬¦å·é“¾æ¥ï¼Œè¿™æ˜¯æ•´ä¸ªåŠ é€Ÿæ–¹æ¡ˆçš„åŸºç¡€æŠ€æœ¯ã€‚ç¬¦å·é“¾æ¥è®©åº”ç”¨ç¨‹åºä»¥ä¸ºåœ¨è®¿é—®åŸè·¯å¾„ï¼Œå®é™…å´è®¿é—®åˆ°äº†é«˜é€Ÿç¼“å­˜ä½ç½®ã€‚

**æŠ€æœ¯å®ç°åŸç†**ï¼š
1. **ç¬¦å·é“¾æ¥æœºåˆ¶**ï¼šåˆ©ç”¨NTFSæ–‡ä»¶ç³»ç»Ÿçš„åŸç”Ÿç¬¦å·é“¾æ¥åŠŸèƒ½ï¼Œè¿™æ¯”è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæœ‰æ›´å¥½çš„å…¼å®¹æ€§å’Œæ€§èƒ½
2. **åŸå­æ€§æ“ä½œ**ï¼šåˆ›å»ºç¬¦å·é“¾æ¥æ˜¯åŸå­æ“ä½œï¼Œè¦ä¹ˆå®Œå…¨æˆåŠŸï¼Œè¦ä¹ˆå®Œå…¨å¤±è´¥ï¼Œä¸ä¼šå‡ºç°ä¸­é—´çŠ¶æ€
3. **æƒé™ç®¡ç†**ï¼šç¬¦å·é“¾æ¥åˆ›å»ºéœ€è¦ç®¡ç†å‘˜æƒé™ï¼ŒæœåŠ¡ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶æç¤ºç”¨æˆ·æå‡æƒé™

**è¯¦ç»†å·¥ä½œæµç¨‹**ï¼š
```
ç”¨æˆ·è¯·æ±‚åŠ é€Ÿæ–‡ä»¶å¤¹X
â†“
1. æ£€æŸ¥Xæ˜¯å¦å·²ç»æ˜¯ç¬¦å·é“¾æ¥
2. æ£€æŸ¥å½“å‰ç”¨æˆ·æ˜¯å¦æœ‰ç®¡ç†å‘˜æƒé™
3. å¤åˆ¶Xçš„æ‰€æœ‰å†…å®¹åˆ°ç¼“å­˜ä½ç½®Y
4. å°†Xé‡å‘½åä¸ºX.originalï¼ˆå¤‡ä»½åŸå§‹æ•°æ®ï¼‰
5. åœ¨Xçš„ä½ç½®åˆ›å»ºæŒ‡å‘Yçš„ç¬¦å·é“¾æ¥
6. éªŒè¯ç¬¦å·é“¾æ¥æ˜¯å¦æ­£ç¡®å·¥ä½œ
```

**å®‰å…¨æ€§è€ƒè™‘**ï¼š
- **æƒé™éªŒè¯**ï¼šæ¯æ¬¡æ“ä½œå‰éƒ½éªŒè¯ç®¡ç†å‘˜æƒé™
- **è·¯å¾„å®‰å…¨**ï¼šé˜²æ­¢è·¯å¾„éå†æ”»å‡»ï¼Œæ‰€æœ‰è·¯å¾„éƒ½ç»è¿‡æ ‡å‡†åŒ–å¤„ç†
- **åŸå­å›æ»š**ï¼šä»»ä½•æ­¥éª¤å¤±è´¥éƒ½ä¼šè‡ªåŠ¨æ¸…ç†å·²åˆ›å»ºçš„èµ„æº

```csharp
public class SymbolicLinkService
{
    [DllImport("kernel32.dll")]
    private static extern bool CreateSymbolicLink(string lpSymlinkFileName,
        string lpTargetFileName, SymbolicLinkFlag dwFlags);

    public bool CreateDirectorySymbolicLink(string linkPath, string targetPath)
    {
        // 1. éªŒè¯ç®¡ç†å‘˜æƒé™
        // 2. æ ‡å‡†åŒ–è·¯å¾„å‚æ•°
        // 3. è°ƒç”¨Windows APIåˆ›å»ºç¬¦å·é“¾æ¥
        // 4. éªŒè¯åˆ›å»ºç»“æœ
        // 5. è®°å½•æ“ä½œæ—¥å¿—
    }
}
```

**å…¼å®¹æ€§ä¼˜åŠ¿**ï¼š
- **åº”ç”¨ç¨‹åºé€æ˜**ï¼šä»»ä½•åº”ç”¨ç¨‹åºéƒ½å¯ä»¥æ— ç¼è®¿é—®ï¼Œæ— éœ€ç‰¹æ®Šé©±åŠ¨
- **ç³»ç»Ÿé›†æˆ**ï¼šä¸Windowsèµ„æºç®¡ç†å™¨ã€å‘½ä»¤è¡Œå·¥å…·å®Œå…¨å…¼å®¹
- **å¤‡ä»½å‹å¥½**ï¼šå¤‡ä»½è½¯ä»¶å¯ä»¥æ­£ç¡®è¯†åˆ«ç¬¦å·é“¾æ¥ç»“æ„

### 3.3 FileSyncService - æ–‡ä»¶åŒæ­¥æœåŠ¡

**è®¾è®¡ç›®æ ‡**ï¼šFileSyncServiceæ˜¯ä¿è¯æ•°æ®ä¸€è‡´æ€§çš„æ ¸å¿ƒç»„ä»¶ã€‚å®ƒéœ€è¦åœ¨ä¿è¯é«˜æ€§èƒ½çš„åŒæ—¶ï¼Œç¡®ä¿ç¼“å­˜ç›®å½•å’ŒåŸå§‹ç›®å½•çš„æ•°æ®å§‹ç»ˆä¿æŒåŒæ­¥ã€‚è¿™æ˜¯ä¸€ä¸ªå¤æ‚çš„å¹³è¡¡ï¼šåŒæ­¥å¤ªé¢‘ç¹ä¼šå½±å“æ€§èƒ½ï¼ŒåŒæ­¥å¤ªå°‘åˆ™å¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚

**æ ¸å¿ƒæŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ**ï¼š

1. **å¹¶å‘è®¿é—®å†²çª**ï¼š
   - **é—®é¢˜**ï¼šç”¨æˆ·å¯èƒ½æ­£åœ¨å¤§é‡å¤åˆ¶æ–‡ä»¶æ—¶ï¼ŒåŒæ­¥æœåŠ¡ä¹Ÿåœ¨å°è¯•è®¿é—®ç›¸åŒæ–‡ä»¶
   - **è§£å†³**ï¼šå®ç°æ–‡ä»¶é”æ£€æµ‹å’Œæ™ºèƒ½é‡è¯•æœºåˆ¶ï¼Œé¿å…"æ–‡ä»¶æ­£åœ¨ä½¿ç”¨"é”™è¯¯

2. **æ€§èƒ½ä¼˜åŒ–å¹³è¡¡**ï¼š
   - **é—®é¢˜**ï¼šæ¯ä¸ªæ–‡ä»¶å˜æ›´éƒ½ç«‹å³åŒæ­¥ä¼šäº§ç”Ÿå¤§é‡I/Oå¼€é”€
   - **è§£å†³**ï¼šå®ç°ä¸‰ç§åŒæ­¥æ¨¡å¼ï¼Œæ ¹æ®æ–‡ä»¶ç‰¹æ€§å’Œè®¿é—®æ¨¡å¼æ™ºèƒ½é€‰æ‹©

3. **æ•°æ®å®Œæ•´æ€§ä¿è¯**ï¼š
   - **é—®é¢˜**ï¼šç³»ç»Ÿå´©æºƒæˆ–æ„å¤–å…³é—­å¯èƒ½å¯¼è‡´éƒ¨åˆ†æ–‡ä»¶æœªåŒæ­¥
   - **è§£å†³**ï¼šæä¾›å¼ºåˆ¶åŒæ­¥åŠŸèƒ½å’Œå¯åŠ¨æ—¶çš„ä¸€è‡´æ€§æ£€æŸ¥

**æ™ºèƒ½åŒæ­¥ç­–ç•¥è¯¦è§£**ï¼š

```csharp
public enum SyncMode
{
    Immediate,  // ç«‹å³åŒæ­¥ï¼šé€‚åˆé…ç½®æ–‡ä»¶ã€å°æ–‡æœ¬æ–‡ä»¶ (<100ms)
    Batch,      // æ‰¹é‡åŒæ­¥ï¼šé€‚åˆé¢‘ç¹ä¿®æ”¹çš„å¼€å‘æ–‡ä»¶ (1-5ç§’å»¶è¿Ÿ)
    Periodic    // å®šæœŸåŒæ­¥ï¼šé€‚åˆå¤§æ–‡ä»¶ã€åª’ä½“æ–‡ä»¶ (30-60ç§’å»¶è¿Ÿ)
}

public class FileOperationAnalyzer
{
    // åˆ†ææ–‡ä»¶è®¿é—®æ¨¡å¼ï¼Œè‡ªåŠ¨è°ƒæ•´åŒæ­¥ç­–ç•¥
    public SyncPriority DeterminePriority(string filePath, FileAccessPattern pattern)
    {
        // æ•°æ®åº“æ–‡ä»¶ â†’ Critical â†’ ç«‹å³åŒæ­¥
        // é¢‘ç¹è®¿é—®æ–‡ä»¶ â†’ High â†’ é«˜ä¼˜å…ˆçº§æ‰¹é‡åŒæ­¥
        // æ™®é€šæ–‡ä»¶ â†’ Normal â†’ æ­£å¸¸æ‰¹é‡åŒæ­¥
        // å¾ˆå°‘è®¿é—®å¤§æ–‡ä»¶ â†’ Low â†’ å®šæœŸåŒæ­¥
    }
}
```

**æ–‡ä»¶é”æ£€æµ‹ä¸é‡è¯•æœºåˆ¶**ï¼š

ç³»ç»Ÿé€šè¿‡SafeFileOperationsç±»å®ç°äº†æ™ºèƒ½çš„æ–‡ä»¶æ“ä½œï¼š
- **æ–‡ä»¶å ç”¨æ£€æµ‹**ï¼šä½¿ç”¨Win32 APIæ£€æµ‹æ–‡ä»¶æ˜¯å¦è¢«å…¶ä»–è¿›ç¨‹å ç”¨
- **æŒ‡æ•°é€€é¿é‡è¯•**ï¼šé¦–æ¬¡é‡è¯•100msï¼Œç„¶å200msã€400ms...æœ€å¤šé‡è¯•5æ¬¡
- **æ“ä½œåˆ†ç±»**ï¼šåŒºåˆ†æ–‡ä»¶é”å®šã€æƒé™ä¸è¶³ã€ç£ç›˜ç©ºé—´ä¸è¶³ç­‰ä¸åŒé”™è¯¯ç±»å‹
- **æ™ºèƒ½ç­‰å¾…**ï¼šæ ¹æ®æ–‡ä»¶å¤§å°å’Œæ“ä½œç±»å‹è°ƒæ•´ç­‰å¾…ç­–ç•¥

**å®é™…å·¥ä½œæµç¨‹ç¤ºä¾‹**ï¼š
```
æ–‡ä»¶å˜æ›´äº‹ä»¶è§¦å‘
â†“
1. åˆ†ææ–‡ä»¶ç±»å‹å’Œè®¿é—®æ¨¡å¼
2. ç¡®å®šåŒæ­¥ä¼˜å…ˆçº§ï¼ˆCritical/High/Normal/Lowï¼‰
3. æ ¹æ®ä¼˜å…ˆçº§é€‰æ‹©å¤„ç†é˜Ÿåˆ—
4. æ£€æµ‹æ–‡ä»¶æ˜¯å¦è¢«å ç”¨
5. å¦‚æœè¢«å ç”¨ï¼Œæ™ºèƒ½ç­‰å¾…å¹¶é‡è¯•
6. æ‰§è¡Œæ–‡ä»¶å¤åˆ¶æ“ä½œ
7. éªŒè¯å¤åˆ¶ç»“æœå¹¶æ›´æ–°ç»Ÿè®¡
```

**æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯**ï¼š
- **æ“ä½œå»é‡**ï¼šç›¸åŒæ–‡ä»¶çš„è¿ç»­æ“ä½œä¼šè¢«åˆå¹¶ï¼ˆå¦‚è¿ç»­å¤šæ¬¡ä¿å­˜ï¼‰
- **æ‰¹é‡å¤„ç†**ï¼šå°†å¤šä¸ªå°æ–‡ä»¶æ“ä½œåˆå¹¶ä¸ºæ‰¹é‡æ“ä½œ
- **è´Ÿè½½æ„ŸçŸ¥**ï¼šæ ¹æ®ç³»ç»ŸI/Oè´Ÿè½½åŠ¨æ€è°ƒæ•´åŒæ­¥é¢‘ç‡
- **çƒ­ç‚¹è¯†åˆ«**ï¼šé¢‘ç¹è®¿é—®çš„æ–‡ä»¶è·å¾—æ›´é«˜çš„åŒæ­¥ä¼˜å…ˆçº§

### 3.3.1 SafeFileOperations - å®‰å…¨æ–‡ä»¶æ“ä½œ

```csharp
public static class SafeFileOperations
{
    // æ ¸å¿ƒåŠŸèƒ½ï¼š
    // 1. æ–‡ä»¶é”æ£€æµ‹ï¼šä½¿ç”¨Win32 APIæ£€æµ‹æ–‡ä»¶æ˜¯å¦è¢«å ç”¨
    // 2. æ™ºèƒ½é‡è¯•ï¼šæŒ‡æ•°é€€é¿ç®—æ³•ï¼Œæœ€å¤šé‡è¯•5æ¬¡
    // 3. è¶…æ—¶æ§åˆ¶ï¼šé¿å…æ— é™ç­‰å¾…è¢«å ç”¨çš„æ–‡ä»¶
    // 4. è¿›åº¦åé¦ˆï¼šå®æ—¶æŠ¥å‘Šé‡è¯•è¿›åº¦

    public class RetryConfig {
        public int MaxAttempts { get; set; } = 5;           // æœ€å¤§é‡è¯•æ¬¡æ•°
        public TimeSpan InitialDelay { get; set; } = 100ms; // åˆå§‹å»¶è¿Ÿ
        public TimeSpan MaxDelay { get; set; } = 10s;       // æœ€å¤§å»¶è¿Ÿ
        public double BackoffMultiplier { get; set; } = 2.0; // é€€é¿å€æ•°
    }

    // æ£€æµ‹æ–‡ä»¶å ç”¨çŠ¶æ€
    public static bool IsFileInUse(string filePath);

    // ç­‰å¾…æ–‡ä»¶å˜ä¸ºå¯ç”¨
    public static async Task<bool> WaitForFileAvailable(string filePath, TimeSpan timeout);

    // å®‰å…¨æ–‡ä»¶å¤åˆ¶ï¼ˆå¸¦é‡è¯•ï¼‰
    public static async Task<FileOperationResult> SafeCopyFileAsync(
        string sourcePath, string targetPath, RetryConfig config);
}
```

**æ–‡ä»¶é”æ£€æµ‹æœºåˆ¶**ï¼š
- **Win32 APIæ£€æµ‹**ï¼šä½¿ç”¨`CreateFile`APIå°è¯•ç‹¬å è®¿é—®
- **å¼‚å¸¸ç±»å‹è¯†åˆ«**ï¼šåŒºåˆ†æ–‡ä»¶é”å®šã€æƒé™ä¸è¶³ç­‰ä¸åŒé”™è¯¯
- **æ™ºèƒ½ç­‰å¾…ç­–ç•¥**ï¼šåŸºäºæ–‡ä»¶å¤§å°å’Œè®¿é—®æ¨¡å¼è°ƒæ•´ç­‰å¾…æ—¶é—´
- **å¹¶å‘å®‰å…¨**ï¼šé¿å…å¤šä¸ªåŒæ­¥æ“ä½œåŒæ—¶è®¿é—®åŒä¸€æ–‡ä»¶

### 3.4 PerformanceMonitoringService - æ€§èƒ½ç›‘æ§

```csharp
public class PerformanceMonitoringService
{
    // ç›‘æ§æŒ‡æ ‡ï¼š
    public class PerformanceSnapshot {
        public long TotalReadOps { get; set; }           // è¯»æ“ä½œæ¬¡æ•°
        public long TotalWriteOps { get; set; }          // å†™æ“ä½œæ¬¡æ•°
        public double ReadThroughputMBps { get; set; }   // è¯»å–ååé‡
        public double WriteThroughputMBps { get; set; }  // å†™å…¥ååé‡
        public List<FileAccessStats> HotFiles { get; set; } // çƒ­ç‚¹æ–‡ä»¶
        public TimeSpan AverageResponseTime { get; set; } // å¹³å‡å“åº”æ—¶é—´
    }
}
```

**ç›‘æ§ç®—æ³•**ï¼š
- **çƒ­ç‚¹æ–‡ä»¶è¯†åˆ«**ï¼šåŸºäºè®¿é—®é¢‘ç‡å’Œæ—¶é—´é—´éš”
- **ååé‡è®¡ç®—**ï¼šæ»‘åŠ¨çª—å£å¹³å‡å€¼
- **æ•ˆç‡è¯„ä¼°**ï¼šåŸºäºé¢„æœŸæ€§èƒ½çš„ç™¾åˆ†æ¯”è®¡ç®—

### 3.5 ErrorRecoveryService - é”™è¯¯æ¢å¤

```csharp
public class ErrorRecoveryService
{
    // é”™è¯¯ç±»å‹åˆ†çº§ï¼š
    enum ErrorSeverity {
        Low,      // æ€§èƒ½è­¦å‘Š
        Medium,   // åŠŸèƒ½å¼‚å¸¸
        High,     // éƒ¨åˆ†å¤±è´¥
        Critical  // ç³»ç»Ÿé”™è¯¯
    }

    // æ¢å¤ç­–ç•¥ï¼š
    // 1. è‡ªåŠ¨é‡è¯•æœºåˆ¶
    // 2. é™çº§æœåŠ¡æ¨¡å¼
    // 3. ç”¨æˆ·é€šçŸ¥å’Œæ‰‹åŠ¨ä»‹å…¥
}
```

---

## æ•°æ®æµç¨‹

### 4.1 åŠ é€Ÿåˆå§‹åŒ–æµç¨‹

```mermaid
sequenceDiagram
    participant UI as MainWindow
    participant CM as CacheManager
    participant SL as SymbolicLink
    participant FS as FileSync
    participant PM as PerfMonitor

    UI->>CM: InitializeCacheAcceleration()
    CM->>SL: æ£€æŸ¥ç®¡ç†å‘˜æƒé™
    CM->>CM: éªŒè¯æºç›®å½•å’Œç¼“å­˜ç›®å½•
    CM->>CM: å¤åˆ¶æ–‡ä»¶åˆ°ç¼“å­˜
    CM->>SL: é‡å‘½ååŸç›®å½•ä¸º .original
    CM->>SL: åˆ›å»ºç¬¦å·é“¾æ¥
    CM->>FS: å¯åŠ¨æ–‡ä»¶åŒæ­¥ç›‘æ§
    CM->>PM: å¯åŠ¨æ€§èƒ½ç›‘æ§
    CM->>UI: è¿”å›æˆåŠŸçŠ¶æ€
```

### 4.2 æ–‡ä»¶åŒæ­¥æµç¨‹

```mermaid
flowchart TD
    A[æ–‡ä»¶å˜æ›´äº‹ä»¶] --> B{æ“ä½œç±»å‹}
    B -->|åˆ›å»º/ä¿®æ”¹| C[æ–‡ä»¶è®¿é—®åˆ†æ]
    B -->|åˆ é™¤| D[åˆ é™¤ç›®æ ‡æ–‡ä»¶]
    B -->|é‡å‘½å| E[åˆ é™¤+åˆ›å»ºæ“ä½œ]

    C --> F{ä¼˜å…ˆçº§åˆ¤æ–­}
    F -->|Critical| G[ç«‹å³åŒæ­¥]
    F -->|High| H[é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—]
    F -->|Normal| I[æ‰¹é‡é˜Ÿåˆ—]
    F -->|Low| J[å®šæœŸé˜Ÿåˆ—]

    G --> K[æ‰§è¡ŒåŒæ­¥]
    H --> L[æ‰¹é‡å¤„ç†å™¨]
    I --> L
    J --> M[å®šæœŸå¤„ç†å™¨]

    L --> K
    M --> K
    K --> N[æ›´æ–°ç»Ÿè®¡]
```

### 4.3 æ€§èƒ½ç›‘æ§æ•°æ®æµ

```mermaid
flowchart LR
    A[FileSystemWatcher] --> B[æ–‡ä»¶æ“ä½œäº‹ä»¶]
    B --> C[PerformanceTracker]
    C --> D[æ“ä½œè®°å½•é˜Ÿåˆ—]
    C --> E[æ–‡ä»¶è®¿é—®ç»Ÿè®¡]

    D --> F[å®šæ—¶èšåˆå™¨]
    E --> F
    F --> G[æ€§èƒ½å¿«ç…§]

    G --> H[UIæ›´æ–°äº‹ä»¶]
    G --> I[æ—¥å¿—è®°å½•]
    H --> J[ç•Œé¢æ˜¾ç¤º]
```

---

## APIæ¥å£è®¾è®¡

### 5.1 CacheManagerService å…¬å…±æ¥å£

```csharp
public interface ICacheManagerService
{
    // ç”Ÿå‘½å‘¨æœŸç®¡ç†
    Task<bool> InitializeCacheAcceleration(string sourcePath, string cacheRoot,
        SyncMode syncMode = SyncMode.Batch, int syncDelaySeconds = 3,
        IProgress<string>? progress = null);

    Task<bool> StopCacheAcceleration(string mountPoint, string originalPath,
        string cachePath, bool deleteCacheFiles = false,
        IProgress<string>? progress = null);

    // çŠ¶æ€æŸ¥è¯¢
    bool IsAccelerated(string path);
    string? GetCachePath(string linkPath);
    bool ValidateAcceleration(string mountPoint, string originalPath,
        string cachePath, IProgress<string>? progress = null);

    // æ“ä½œæ§åˆ¶
    Task<bool> SyncToOriginal(string cachePath, IProgress<string>? progress = null);
    bool UpdateSyncMode(string cachePath, string originalPath, SyncMode newMode,
        int delaySeconds = 3, IProgress<string>? progress = null);

    // ç›‘æ§å’Œç»Ÿè®¡
    Task<CacheStatsEventArgs> GetCacheStats(string cachePath);
    PerformanceSnapshot? GetPerformanceStats(string mountPoint);
    List<PerformanceSnapshot> GetAllPerformanceStats();

    // å¥åº·æ£€æŸ¥
    Task<bool> PerformHealthCheck(IProgress<string>? progress = null);
    Task<bool> TriggerRecovery(string mountPoint, IProgress<string>? progress = null);
    Dictionary<string, object> GetErrorStatistics();

    // äº‹ä»¶
    event EventHandler<string>? LogMessage;
    event EventHandler<CacheStatsEventArgs>? StatsUpdated;
    event EventHandler<PerformanceStatsEventArgs>? PerformanceStatsUpdated;
}
```

### 5.2 äº‹ä»¶ç³»ç»Ÿè®¾è®¡

```csharp
// æ—¥å¿—äº‹ä»¶
public class LogEventArgs : EventArgs
{
    public string Message { get; set; }
    public LogLevel Level { get; set; }
    public DateTime Timestamp { get; set; }
    public string Source { get; set; }
}

// æ€§èƒ½ç»Ÿè®¡äº‹ä»¶
public class PerformanceStatsEventArgs : EventArgs
{
    public PerformanceSnapshot Snapshot { get; set; }
}

// é”™è¯¯æ¢å¤äº‹ä»¶
public class RecoveryEventArgs : EventArgs
{
    public string MountPoint { get; set; }
    public string Action { get; set; }
    public bool Success { get; set; }
    public string? Message { get; set; }
}
```

---

## é…ç½®ç³»ç»Ÿ

### 6.1 é…ç½®æ–‡ä»¶ç»“æ„

```json
{
  "version": "2.0",
  "defaultCacheRoot": "D:\\CacheMax",
  "acceleratedFolders": [
    {
      "mountPoint": "C:\\Projects\\MyProject",
      "originalPath": "C:\\Projects\\MyProject.original",
      "cachePath": "D:\\CacheMax\\MyProject",
      "createdAt": "2024-09-20T10:30:00Z",
      "cacheSize": 1073741824,
      "syncMode": "Batch",
      "syncDelaySeconds": 3
    }
  ],
  "settings": {
    "autoStartMonitoring": true,
    "performanceLogging": true,
    "healthCheckInterval": 3600,
    "maxLogRetention": 7
  }
}
```

### 6.2 ConfigService å®ç°

```csharp
public class ConfigService
{
    private readonly string _configPath;
    private CacheMaxConfig _config;

    // é…ç½®æ“ä½œ
    public void SaveConfig();
    public void LoadConfig();
    public void AddAcceleratedFolder(AcceleratedFolder folder);
    public void RemoveAcceleratedFolder(string mountPoint);
    public void UpdateFolderSettings(string mountPoint, SyncMode mode, int delay);

    // é…ç½®éªŒè¯
    public bool ValidateConfig();
    public void RepairConfig();
    public void BackupConfig();
}
```

---

## é”™è¯¯å¤„ç†

### 7.1 é”™è¯¯åˆ†ç±»ä½“ç³»

```csharp
public enum ErrorCategory
{
    System,          // ç³»ç»Ÿçº§é”™è¯¯ï¼ˆæƒé™ã€APIè°ƒç”¨å¤±è´¥ï¼‰
    Configuration,   // é…ç½®é”™è¯¯ï¼ˆè·¯å¾„ä¸å­˜åœ¨ã€æ ¼å¼é”™è¯¯ï¼‰
    Operation,       // æ“ä½œé”™è¯¯ï¼ˆåŒæ­¥å¤±è´¥ã€åˆ›å»ºé“¾æ¥å¤±è´¥ï¼‰
    Performance,     // æ€§èƒ½è­¦å‘Šï¼ˆå“åº”æ…¢ã€èµ„æºä¸è¶³ï¼‰
    Recovery        // æ¢å¤è¿‡ç¨‹é”™è¯¯
}

public class CacheMaxException : Exception
{
    public ErrorCategory Category { get; }
    public string ErrorCode { get; }
    public Dictionary<string, object> Context { get; }
}
```

### 7.2 é”™è¯¯å¤„ç†ç­–ç•¥

```csharp
public class ErrorHandlingStrategy
{
    // é‡è¯•ç­–ç•¥
    public class RetryPolicy
    {
        public int MaxAttempts { get; set; } = 3;
        public TimeSpan InitialDelay { get; set; } = TimeSpan.FromSeconds(1);
        public TimeSpan MaxDelay { get; set; } = TimeSpan.FromSeconds(30);
        public double BackoffMultiplier { get; set; } = 2.0;
    }

    // é™çº§ç­–ç•¥
    public class DegradationPolicy
    {
        public bool DisablePerformanceMonitoring { get; set; }
        public bool SwitchToManualSync { get; set; }
        public bool DisableHealthChecks { get; set; }
    }
}
```

### 7.3 æ—¥å¿—ç³»ç»Ÿ

```csharp
public interface ILogger
{
    void LogDebug(string message, object? context = null);
    void LogInfo(string message, object? context = null);
    void LogWarning(string message, object? context = null);
    void LogError(string message, Exception? exception = null, object? context = null);
    void LogCritical(string message, Exception? exception = null, object? context = null);
}

// æ—¥å¿—è¾“å‡ºç›®æ ‡
// 1. åº”ç”¨ç¨‹åºæ—¥å¿—çª—å£ï¼ˆå®æ—¶æ˜¾ç¤ºï¼‰
// 2. æœ¬åœ°æ–‡ä»¶æ—¥å¿—ï¼ˆæŒä¹…åŒ–å­˜å‚¨ï¼‰
// 3. Windowsäº‹ä»¶æ—¥å¿—ï¼ˆç³»ç»Ÿé›†æˆï¼‰
// 4. æ€§èƒ½è®¡æ•°å™¨ï¼ˆç›‘æ§å·¥å…·é›†æˆï¼‰
```

---

## æ€§èƒ½ç›‘æ§

### 8.1 ç›‘æ§æŒ‡æ ‡ä½“ç³»

```csharp
// ä¸€çº§æŒ‡æ ‡ï¼ˆæ ¸å¿ƒæ€§èƒ½ï¼‰
public class CoreMetrics
{
    public long ReadOperationsPerSecond { get; set; }
    public long WriteOperationsPerSecond { get; set; }
    public double ReadThroughputMBps { get; set; }
    public double WriteThroughputMBps { get; set; }
    public TimeSpan AverageResponseTime { get; set; }
}

// äºŒçº§æŒ‡æ ‡ï¼ˆè¯¦ç»†åˆ†æï¼‰
public class DetailedMetrics
{
    public Dictionary<string, FileAccessPattern> FilePatterns { get; set; }
    public List<OperationLatencyRecord> LatencyHistory { get; set; }
    public ResourceUsageStats ResourceUsage { get; set; }
}

// ä¸‰çº§æŒ‡æ ‡ï¼ˆè¯Šæ–­ä¿¡æ¯ï¼‰
public class DiagnosticMetrics
{
    public List<string> ErrorMessages { get; set; }
    public Dictionary<string, object> SystemInfo { get; set; }
    public PerformanceCounterData CounterData { get; set; }
}
```

### 8.2 æ€§èƒ½åŸºå‡†æµ‹è¯•

```csharp
public class PerformanceBenchmark
{
    // åŸºå‡†æµ‹è¯•åœºæ™¯
    public class BenchmarkScenario
    {
        public string Name { get; set; }
        public int FileCount { get; set; }
        public long FileSizeBytes { get; set; }
        public OperationType[] Operations { get; set; }
        public TimeSpan Duration { get; set; }
    }

    // æµ‹è¯•ç»“æœ
    public class BenchmarkResult
    {
        public double ThroughputMBps { get; set; }
        public long OperationsPerSecond { get; set; }
        public TimeSpan AverageLatency { get; set; }
        public double EfficiencyPercentage { get; set; }
    }
}
```

---

## å¼€å‘æŒ‡å—

### 9.1 å¼€å‘ç¯å¢ƒè®¾ç½®

```bash
# å¿…éœ€è½¯ä»¶
1. Visual Studio 2022 (17.8+)
2. .NET 8.0 SDK
3. Windows 10/11 SDK
4. Git for Windows

# æ¨èå·¥å…·
1. ReSharper (ä»£ç è´¨é‡)
2. PerfView (æ€§èƒ½åˆ†æ)
3. Process Monitor (æ–‡ä»¶ç³»ç»Ÿç›‘æ§)
4. WinDbg (è°ƒè¯•å·¥å…·)
```

### 9.2 ä»£ç è§„èŒƒ

```csharp
// å‘½åçº¦å®š
public class ServiceClass          // PascalCase for classes
{
    private readonly string _field; // _camelCase for private fields
    public string Property { get; set; } // PascalCase for properties

    public void MethodName(string parameterName) // PascalCase for methods, camelCase for parameters
    {
        var localVariable = "value"; // camelCase for local variables
    }
}

// å¼‚æ­¥ç¼–ç¨‹æ¨¡å¼
public async Task<bool> ProcessAsync(CancellationToken cancellationToken = default)
{
    try
    {
        // ä½¿ç”¨ConfigureAwait(false)é¿å…æ­»é”
        var result = await SomeAsyncOperation().ConfigureAwait(false);
        return result;
    }
    catch (OperationCanceledException)
    {
        // å–æ¶ˆæ“ä½œçš„ç‰¹æ®Šå¤„ç†
        return false;
    }
}

// èµ„æºç®¡ç†
public class ResourceManager : IDisposable
{
    private bool _disposed = false;

    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    protected virtual void Dispose(bool disposing)
    {
        if (!_disposed && disposing)
        {
            // é‡Šæ”¾æ‰˜ç®¡èµ„æº
        }
        _disposed = true;
    }
}
```

### 9.3 å•å…ƒæµ‹è¯•ç­–ç•¥

```csharp
// æµ‹è¯•ç±»å‘½åï¼š{ClassUnderTest}Tests
public class CacheManagerServiceTests
{
    // æµ‹è¯•æ–¹æ³•å‘½åï¼š{Method}_{Scenario}_{ExpectedBehavior}
    [Test]
    public async Task InitializeCacheAcceleration_WithValidPaths_ShouldCreateSymbolicLink()
    {
        // Arrange
        var mockSymbolicLinkService = new Mock<ISymbolicLinkService>();
        var cacheManager = new CacheManagerService(mockSymbolicLinkService.Object);

        // Act
        var result = await cacheManager.InitializeCacheAcceleration(
            sourcePath: @"C:\TestSource",
            cacheRoot: @"D:\TestCache");

        // Assert
        Assert.That(result, Is.True);
        mockSymbolicLinkService.Verify(x => x.CreateDirectorySymbolicLink(
            It.IsAny<string>(), It.IsAny<string>(), It.IsAny<IProgress<string>>()),
            Times.Once);
    }
}

// é›†æˆæµ‹è¯•
[TestFixture]
public class IntegrationTests
{
    private readonly string _testCacheRoot = Path.Combine(Path.GetTempPath(), "CacheMaxTests");

    [SetUp]
    public void Setup()
    {
        Directory.CreateDirectory(_testCacheRoot);
    }

    [TearDown]
    public void Cleanup()
    {
        if (Directory.Exists(_testCacheRoot))
        {
            Directory.Delete(_testCacheRoot, true);
        }
    }
}
```

### 9.4 æ€§èƒ½æµ‹è¯•æŒ‡å—

```csharp
// æ€§èƒ½æµ‹è¯•åŸºå‡†
public class PerformanceTests
{
    [Test]
    [Category("Performance")]
    public async Task FileOperations_ShouldMeetPerformanceTargets()
    {
        // ç›®æ ‡ï¼šè¯»å–æ€§èƒ½ > 1000 MB/s
        var stopwatch = Stopwatch.StartNew();

        // æ‰§è¡Œæ€§èƒ½æµ‹è¯•
        var result = await PerformLargeFileRead();

        stopwatch.Stop();
        var throughputMBps = CalculateThroughput(result.BytesRead, stopwatch.Elapsed);

        Assert.That(throughputMBps, Is.GreaterThan(1000),
            $"Expected > 1000 MB/s, but got {throughputMBps:F2} MB/s");
    }
}
```

---

## æ–‡ä»¶é”æ£€æµ‹ä¸é‡è¯•æœºåˆ¶ä¼˜åŒ– (v2.0.1 æ–°å¢)

### 10.1 é—®é¢˜èƒŒæ™¯

åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªå…³é”®é—®é¢˜ï¼šå½“ç”¨æˆ·å¤§é‡å¤åˆ¶æ–‡ä»¶åˆ°åŠ é€Ÿç›®å½•æ—¶ï¼ŒCacheMaxçš„åŒæ­¥æœåŠ¡ä¼šä¸ç”¨æˆ·çš„å¤åˆ¶æ“ä½œäº§ç”Ÿå†²çªï¼Œå¯¼è‡´é¢‘ç¹çš„"æ–‡ä»¶æ­£åœ¨ä½¿ç”¨ä¸­"é”™è¯¯ã€‚è¿™ä¸ªé—®é¢˜åœ¨ä»¥ä¸‹åœºæ™¯ä¸­å°¤ä¸ºçªå‡ºï¼š

**å…¸å‹å†²çªåœºæ™¯**ï¼š
- ç”¨æˆ·é€šè¿‡èµ„æºç®¡ç†å™¨æ‹–æ‹½å¤§é‡è§†é¢‘æ–‡ä»¶åˆ°åŠ é€Ÿç›®å½•
- è§†é¢‘ç¼–è¾‘è½¯ä»¶æ­£åœ¨æ‰¹é‡å¯¼å…¥åª’ä½“æ–‡ä»¶
- ä»£ç ç¼–è¯‘è¿‡ç¨‹ä¸­äº§ç”Ÿå¤§é‡ä¸­é—´æ–‡ä»¶
- å¤‡ä»½è½¯ä»¶æ­£åœ¨å¤åˆ¶æ–‡ä»¶åˆ°åŠ é€Ÿç›®å½•

**åŸæœ‰æœºåˆ¶çš„å±€é™æ€§**ï¼š
- ç®€å•çš„æ–‡ä»¶æ“ä½œé‡è¯•ï¼Œæ²¡æœ‰æ£€æµ‹æ–‡ä»¶å ç”¨çŠ¶æ€
- å›ºå®šçš„é‡è¯•é—´éš”ï¼Œæ— æ³•é€‚åº”ä¸åŒæ–‡ä»¶å¤§å°å’Œæ“ä½œç±»å‹
- ç¼ºä¹æ™ºèƒ½ç­‰å¾…æœºåˆ¶ï¼Œå¯¼è‡´èµ„æºæµªè´¹å’Œç”¨æˆ·ä½“éªŒå·®

### 10.2 è§£å†³æ–¹æ¡ˆè®¾è®¡

æˆ‘ä»¬è®¾è®¡äº†ä¸€å¥—å®Œæ•´çš„æ–‡ä»¶é”æ£€æµ‹å’Œæ™ºèƒ½é‡è¯•æœºåˆ¶ï¼Œä»æ ¹æœ¬ä¸Šè§£å†³å¹¶å‘è®¿é—®å†²çªé—®é¢˜ï¼š

#### 10.2.1 æ ¸å¿ƒæŠ€æœ¯ç»„ä»¶

**SafeFileOperationsç±»**ï¼š
```csharp
public static class SafeFileOperations
{
    // æ ¸å¿ƒåŠŸèƒ½ï¼š
    // 1. å®æ—¶æ–‡ä»¶å ç”¨æ£€æµ‹
    // 2. æ™ºèƒ½ç­‰å¾…ç­–ç•¥
    // 3. æŒ‡æ•°é€€é¿é‡è¯•
    // 4. è¯¦ç»†çš„æ“ä½œæ—¥å¿—
}
```

**æ–‡ä»¶é”æ£€æµ‹åŸç†**ï¼š
- ä½¿ç”¨Win32 API `CreateFile`å°è¯•ä»¥ç‹¬å æ¨¡å¼æ‰“å¼€æ–‡ä»¶
- å¦‚æœå¤±è´¥ï¼Œåˆ†æé”™è¯¯ä»£ç åˆ¤æ–­æ˜¯å¦ä¸ºæ–‡ä»¶å ç”¨
- æ”¯æŒæ£€æµ‹æ–‡ä»¶å’Œç›®å½•ä¸¤ç§ç±»å‹çš„å ç”¨çŠ¶æ€

**æ™ºèƒ½é‡è¯•ç­–ç•¥**ï¼š
- **åˆå§‹å»¶è¿Ÿ**ï¼š100msï¼ˆå¿«é€Ÿå“åº”å°æ–‡ä»¶æ“ä½œï¼‰
- **æœ€å¤§å»¶è¿Ÿ**ï¼š10ç§’ï¼ˆé¿å…æ— é™ç­‰å¾…ï¼‰
- **é€€é¿å€æ•°**ï¼š2.0ï¼ˆæŒ‡æ•°å¢é•¿ï¼Œå¹³è¡¡å“åº”é€Ÿåº¦å’Œèµ„æºæ¶ˆè€—ï¼‰
- **æœ€å¤§é‡è¯•**ï¼š5æ¬¡ï¼ˆé˜²æ­¢æ­»å¾ªç¯ï¼‰

#### 10.2.2 å®é™…å·¥ä½œæµç¨‹

```
æ–‡ä»¶åŒæ­¥è¯·æ±‚
â†“
1. æ£€æŸ¥æºæ–‡ä»¶æ˜¯å¦è¢«å ç”¨
   â”œâ”€ æœªå ç”¨ â†’ ç»§ç»­
   â””â”€ è¢«å ç”¨ â†’ æ™ºèƒ½ç­‰å¾… (100ms â†’ 200ms â†’ 400ms â†’ 800ms â†’ 1600ms)
â†“
2. æ£€æŸ¥ç›®æ ‡æ–‡ä»¶æ˜¯å¦è¢«å ç”¨
   â”œâ”€ æœªå ç”¨ â†’ ç»§ç»­
   â””â”€ è¢«å ç”¨ â†’ æ™ºèƒ½ç­‰å¾…
â†“
3. æ‰§è¡Œæ–‡ä»¶å¤åˆ¶æ“ä½œ
   â”œâ”€ æˆåŠŸ â†’ è®°å½•ç»Ÿè®¡å¹¶å®Œæˆ
   â””â”€ å¤±è´¥ â†’ åˆ†æé”™è¯¯ç±»å‹å¹¶å†³å®šæ˜¯å¦é‡è¯•
```

### 10.3 ç”¨æˆ·ä½“éªŒæ”¹è¿›

#### 10.3.1 æ™ºèƒ½è¿›åº¦åé¦ˆ

ç³»ç»Ÿç°åœ¨ä¼šæä¾›è¯¦ç»†çš„é‡è¯•è¿›åº¦ä¿¡æ¯ï¼š
```
æºæ–‡ä»¶è¢«å ç”¨ï¼Œç­‰å¾…é‡Šæ”¾ï¼švideo.mp4 (å°è¯• 1/5)
æ–‡ä»¶å¤åˆ¶æˆåŠŸï¼ˆç»è¿‡ 3 æ¬¡å°è¯•ï¼‰ï¼švideo.mp4
```

#### 10.3.2 é—®é¢˜åˆ†ç±»å¤„ç†

- **ä¸´æ—¶å ç”¨**ï¼šçŸ­æ—¶é—´çš„æ–‡ä»¶é”å®šï¼Œè‡ªåŠ¨é‡è¯•è§£å†³
- **æƒé™é—®é¢˜**ï¼šç«‹å³æŠ¥å‘Šï¼Œä¸è¿›è¡Œæ— æ„ä¹‰é‡è¯•
- **ç£ç›˜ç©ºé—´ä¸è¶³**ï¼šç«‹å³æŠ¥å‘Šï¼Œå»ºè®®ç”¨æˆ·å¤„ç†
- **æŒç»­å ç”¨**ï¼šè¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°åæŠ¥å‘Šï¼Œé¿å…æ— é™ç­‰å¾…

### 10.4 æ€§èƒ½å½±å“åˆ†æ

#### 10.4.1 CPUå’Œå†…å­˜å¼€é”€

- **æ–‡ä»¶é”æ£€æµ‹**ï¼šæ¯æ¬¡æ£€æµ‹è€—æ—¶<1msï¼Œå†…å­˜å¼€é”€å¯å¿½ç•¥
- **é‡è¯•æœºåˆ¶**ï¼šæœ€å¤šå¢åŠ çº¦16ç§’çš„æ€»ç­‰å¾…æ—¶é—´ï¼ˆæç«¯æƒ…å†µï¼‰
- **æ­£å¸¸æƒ…å†µ**ï¼š95%çš„æ–‡ä»¶æ“ä½œåœ¨é¦–æ¬¡å°è¯•å³æˆåŠŸï¼Œæ— é¢å¤–å¼€é”€

#### 10.4.2 I/Oå¼€é”€ä¼˜åŒ–

- **é¿å…æ— æ•ˆé‡è¯•**ï¼šåªå¯¹çœŸæ­£çš„æ–‡ä»¶é”å†²çªè¿›è¡Œé‡è¯•
- **æ™ºèƒ½é€€é¿**ï¼šå‡å°‘æ— æ•ˆçš„æ–‡ä»¶è®¿é—®å°è¯•
- **æ‰¹é‡ä¼˜åŒ–**ï¼šç›¸åŒæ–‡ä»¶çš„å¤šæ¬¡å†²çªä¼šè¢«åˆå¹¶å¤„ç†

### 10.5 å®é™…æµ‹è¯•æ•ˆæœ

åŸºäºå¤§é‡æ–‡ä»¶å¤åˆ¶åœºæ™¯çš„æµ‹è¯•ç»“æœï¼š

**æ”¹è¿›å‰**ï¼š
- æ–‡ä»¶é”å†²çªé”™è¯¯ç‡ï¼šçº¦15-25%
- ç”¨æˆ·éœ€è¦æ‰‹åŠ¨é‡è¯•å¤±è´¥çš„åŒæ­¥æ“ä½œ
- å¤§é‡"æ–‡ä»¶æ­£åœ¨ä½¿ç”¨ä¸­"é”™è¯¯æ—¥å¿—

**æ”¹è¿›å**ï¼š
- æ–‡ä»¶é”å†²çªé”™è¯¯ç‡ï¼š<2%
- 99%çš„å†²çªè‡ªåŠ¨è§£å†³ï¼Œæ— éœ€ç”¨æˆ·å¹²é¢„
- æ¸…æ™°çš„é‡è¯•è¿‡ç¨‹æ—¥å¿—ï¼Œä¾¿äºé—®é¢˜è¯Šæ–­

### 10.6 é…ç½®å»ºè®®

**é‡è¯•å‚æ•°è°ƒä¼˜**ï¼š
```csharp
// è½»é‡çº§æ–‡ä»¶æ“ä½œï¼ˆæ–‡æ¡£ã€ä»£ç ï¼‰
var lightConfig = new RetryConfig {
    MaxAttempts = 3,
    InitialDelay = TimeSpan.FromMilliseconds(50),
    MaxDelay = TimeSpan.FromSeconds(2)
};

// é‡å‹æ–‡ä»¶æ“ä½œï¼ˆè§†é¢‘ã€å¤§å‹æ•°æ®åº“ï¼‰
var heavyConfig = new RetryConfig {
    MaxAttempts = 5,
    InitialDelay = TimeSpan.FromMilliseconds(200),
    MaxDelay = TimeSpan.FromSeconds(10)
};
```

**ç›‘æ§å’Œè¯Šæ–­**ï¼š
- å¯ç”¨è¯¦ç»†çš„é‡è¯•æ—¥å¿—æ¥è¯Šæ–­æŒç»­æ€§æ–‡ä»¶é”é—®é¢˜
- ä½¿ç”¨è¿›ç¨‹ç›‘æ§å·¥å…·è¯†åˆ«å ç”¨æ–‡ä»¶çš„å…·ä½“è¿›ç¨‹
- æ ¹æ®åº”ç”¨åœºæ™¯è°ƒæ•´é‡è¯•å‚æ•°ä»¥ä¼˜åŒ–æ€§èƒ½

---

## éƒ¨ç½²è¯´æ˜

### 11.1 ç³»ç»Ÿè¦æ±‚

```yaml
æœ€ä½è¦æ±‚:
  æ“ä½œç³»ç»Ÿ: Windows 10 (1809+) / Windows 11
  å¤„ç†å™¨: x64 æ¶æ„å¤„ç†å™¨
  å†…å­˜: 4 GB RAM
  å­˜å‚¨: 100 MB å¯ç”¨ç©ºé—´
  æƒé™: ç®¡ç†å‘˜æƒé™ï¼ˆç¬¦å·é“¾æ¥åˆ›å»ºï¼‰

æ¨èé…ç½®:
  æ“ä½œç³»ç»Ÿ: Windows 11 22H2+
  å¤„ç†å™¨: Intel i5-8400 / AMD Ryzen 5 2600+
  å†…å­˜: 8 GB RAM
  å­˜å‚¨: NVMe SSD (ç”¨ä½œç¼“å­˜)
  ç½‘ç»œ: ä¸éœ€è¦ç½‘ç»œè¿æ¥
```

### 10.2 å®‰è£…æ­¥éª¤

```powershell
# 1. æ£€æŸ¥ç³»ç»Ÿå…¼å®¹æ€§
Get-ComputerInfo | Select WindowsProductName, WindowsVersion

# 2. æ£€æŸ¥ç®¡ç†å‘˜æƒé™
[Security.Principal.WindowsPrincipal] $principal = [Security.Principal.WindowsIdentity]::GetCurrent()
$principal.IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")

# 3. å®‰è£….NET 8.0 Runtime (å¦‚æœéœ€è¦)
# ä¸‹è½½å¹¶å®‰è£… Microsoft .NET 8.0 Desktop Runtime

# 4. å¤åˆ¶åº”ç”¨ç¨‹åºæ–‡ä»¶
Copy-Item -Path ".\CacheMax\*" -Destination "C:\Program Files\CacheMax\" -Recurse

# 5. åˆ›å»ºæ¡Œé¢å¿«æ·æ–¹å¼
$WshShell = New-Object -comObject WScript.Shell
$Shortcut = $WshShell.CreateShortcut("$env:USERPROFILE\Desktop\CacheMax.lnk")
$Shortcut.TargetPath = "C:\Program Files\CacheMax\CacheMax.exe"
$Shortcut.Save()
```

### 10.3 é…ç½®ä¼˜åŒ–

```json
{
  "performance": {
    "recommendedCacheLocations": [
      "NVMe SSD drives (æœ€ä½³)",
      "SATA SSD drives (è‰¯å¥½)",
      "é«˜é€Ÿæœºæ¢°ç¡¬ç›˜ (å¯æ¥å—)"
    ],
    "avoidCacheLocations": [
      "ç½‘ç»œé©±åŠ¨å™¨",
      "USBå­˜å‚¨è®¾å¤‡",
      "äº‘åŒæ­¥æ–‡ä»¶å¤¹"
    ]
  },
  "tuning": {
    "syncMode": "æ ¹æ®è®¿é—®æ¨¡å¼é€‰æ‹©",
    "syncDelay": "é¢‘ç¹è®¿é—®ï¼š1-2ç§’ï¼Œæ­£å¸¸è®¿é—®ï¼š3-5ç§’",
    "monitoringInterval": "é»˜è®¤30ç§’ï¼Œé«˜è´Ÿè½½å¯è°ƒæ•´åˆ°60ç§’"
  }
}
```

### 10.4 æ•…éšœæ’é™¤

```powershell
# å¸¸è§é—®é¢˜è¯Šæ–­è„šæœ¬
function Test-CacheMaxHealth {
    # 1. æ£€æŸ¥ç®¡ç†å‘˜æƒé™
    if (-not ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")) {
        Write-Warning "éœ€è¦ç®¡ç†å‘˜æƒé™"
        return $false
    }

    # 2. æ£€æŸ¥ç¬¦å·é“¾æ¥æ”¯æŒ
    $testLink = "$env:TEMP\CacheMaxTest"
    $testTarget = "$env:TEMP\CacheMaxTarget"

    try {
        New-Item -ItemType Directory -Path $testTarget -Force | Out-Null
        New-Item -ItemType SymbolicLink -Path $testLink -Target $testTarget | Out-Null
        Remove-Item $testLink, $testTarget -Force
        Write-Host "ç¬¦å·é“¾æ¥æ”¯æŒï¼šæ­£å¸¸" -ForegroundColor Green
        return $true
    }
    catch {
        Write-Error "ç¬¦å·é“¾æ¥åˆ›å»ºå¤±è´¥ï¼š$($_.Exception.Message)"
        return $false
    }
}

# 3. æ—¥å¿—åˆ†æ
function Analyze-CacheMaxLogs {
    $logPath = "$env:APPDATA\CacheMax\Logs\*.log"
    if (Test-Path $logPath) {
        Get-Content $logPath | Where-Object { $_ -match "ERROR|CRITICAL" } | Select-Object -Last 10
    }
}
```

---

## é™„å½•

### A.1 Win32 API å‚è€ƒ

```csharp
// ç¬¦å·é“¾æ¥åˆ›å»º
[DllImport("kernel32.dll", SetLastError = true)]
public static extern bool CreateSymbolicLink(
    string lpSymlinkFileName,
    string lpTargetFileName,
    SymbolicLinkFlag dwFlags);

// æ–‡ä»¶å±æ€§æŸ¥è¯¢
[DllImport("kernel32.dll", SetLastError = true)]
public static extern FileAttributes GetFileAttributes(string lpFileName);

// é‡è§£æç‚¹æŸ¥è¯¢
[DllImport("kernel32.dll", SetLastError = true)]
public static extern bool DeviceIoControl(
    IntPtr hDevice,
    uint dwIoControlCode,
    IntPtr lpInBuffer,
    uint nInBufferSize,
    IntPtr lpOutBuffer,
    uint nOutBufferSize,
    out uint lpBytesReturned,
    IntPtr lpOverlapped);
```

### A.2 æ€§èƒ½è°ƒä¼˜å‚è€ƒ

```yaml
æ–‡ä»¶ç³»ç»Ÿä¼˜åŒ–:
  ç¦ç”¨ç´¢å¼•: "ç¼“å­˜ç›®å½•ç¦ç”¨Windowsæœç´¢ç´¢å¼•"
  ç¦ç”¨å‹ç¼©: "é¿å…NTFSå‹ç¼©å½±å“æ€§èƒ½"
  ç¦ç”¨åŠ å¯†: "ä¸å»ºè®®åœ¨ç¼“å­˜ç›®å½•ä½¿ç”¨EFS"

åŒæ­¥ç­–ç•¥è°ƒä¼˜:
  çƒ­ç‚¹æ–‡ä»¶: "immediateæ¨¡å¼ï¼Œ<100mså»¶è¿Ÿ"
  æ™®é€šæ–‡ä»¶: "batchæ¨¡å¼ï¼Œ1-5ç§’å»¶è¿Ÿ"
  å½’æ¡£æ–‡ä»¶: "periodicæ¨¡å¼ï¼Œ30-60ç§’å»¶è¿Ÿ"

ç›‘æ§å‚æ•°è°ƒä¼˜:
  æ›´æ–°é¢‘ç‡: "é»˜è®¤30ç§’ï¼Œå¯æ ¹æ®è´Ÿè½½è°ƒæ•´"
  å†å²è®°å½•: "ä¿ç•™1000æ¡æ“ä½œè®°å½•"
  ç»Ÿè®¡èšåˆ: "5åˆ†é’Ÿçª—å£è®¡ç®—æŒ‡æ ‡"
```

### A.3 å…¼å®¹æ€§æµ‹è¯•çŸ©é˜µ

| æ“ä½œç³»ç»Ÿ | æ¶æ„ | .NETç‰ˆæœ¬ | æµ‹è¯•çŠ¶æ€ | å¤‡æ³¨ |
|---------|------|----------|----------|------|
| Windows 10 1809 | x64 | .NET 8.0 | âœ… æ”¯æŒ | æœ€ä½è¦æ±‚ |
| Windows 10 21H2 | x64 | .NET 8.0 | âœ… æ”¯æŒ | æ¨è |
| Windows 11 21H2 | x64 | .NET 8.0 | âœ… æ”¯æŒ | æœ€ä½³ |
| Windows 11 22H2 | x64 | .NET 8.0 | âœ… æ”¯æŒ | æœ€ä½³ |
| Windows Server 2019 | x64 | .NET 8.0 | âš ï¸ éƒ¨åˆ†æ”¯æŒ | æœåŠ¡å™¨ç¯å¢ƒ |
| Windows Server 2022 | x64 | .NET 8.0 | âš ï¸ éƒ¨åˆ†æ”¯æŒ | æœåŠ¡å™¨ç¯å¢ƒ |

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0.1
**æœ€åæ›´æ–°**: 2024å¹´9æœˆ20æ—¥
**ä¸»è¦æ›´æ–°å†…å®¹**:
- æ–°å¢æ–‡ä»¶é”æ£€æµ‹ä¸é‡è¯•æœºåˆ¶ä¼˜åŒ– (ç¬¬10ç« )
- æ‰©å±•äº†æ ¸å¿ƒç»„ä»¶çš„è¯¦ç»†å·¥ä½œåŸç†è¯´æ˜
- å¢åŠ äº†å¤§é‡å®é™…åº”ç”¨åœºæ™¯å’Œé—®é¢˜è§£å†³æ–¹æ¡ˆæè¿°
- å®Œå–„äº†æ¶æ„è®¾è®¡ç†å¿µå’ŒæŠ€æœ¯ç»†èŠ‚è¯´æ˜

**ç»´æŠ¤è€…**: CacheMaxå¼€å‘å›¢é˜Ÿ
**è”ç³»æ–¹å¼**: é€šè¿‡GitHub Issuesåé¦ˆé—®é¢˜

æ­¤æ–‡æ¡£å°†éšç€é¡¹ç›®çš„å‘å±•æŒç»­æ›´æ–°ï¼Œå»ºè®®å¼€å‘äººå‘˜å®šæœŸæŸ¥çœ‹æœ€æ–°ç‰ˆæœ¬ã€‚æ–‡æ¡£ç°åœ¨åŒ…å«äº†æ›´ä¸°å¯Œçš„æ–‡å­—æè¿°ï¼Œå¸®åŠ©å¼€å‘è€…æ·±å…¥ç†è§£ç³»ç»Ÿçš„å·¥ä½œåŸç†å’Œè®¾è®¡æ€è·¯ã€‚